<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>Font Generator ‚Äî PirateRuler</title>
<meta name="description" content="Font Generator by PirateRuler ‚Äî fancy text transforms client-side. No API." />
<meta name="theme-color" content="#f7fbff" />
<link rel="icon" href='data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64"><rect rx="14" width="64" height="64" fill="%236b7dff"/><text x="50%" y="50%" font-family="Inter,Arial,sans-serif" font-weight="800" font-size="26" text-anchor="middle" alignment-baseline="central" fill="white">PR</text></svg>'>
<style>
  :root{
    --bg:#f3f7fb; --card:#ffffff; --muted:#6b7480; --text:#0b2130;
    --accent-start:#6b7dff; --accent-end:#0bb3ff;
    --glass: rgba(11,17,28,0.04);
    --radius:14px; --shadow-lg: 0 18px 50px rgba(3,12,30,0.18);
    --shadow-sm: 0 8px 24px rgba(3,12,30,0.08);
  }
  html.dark{ --bg:#071225; --card:#071827; --muted:#98a7bf; --text:#e9f1ff; --accent-start:#5ab3ff; --accent-end:#6b7dff; --glass: rgba(255,255,255,0.02); --shadow-lg: 0 18px 50px rgba(0,0,0,0.6); --shadow-sm: 0 8px 24px rgba(0,0,0,0.45); }
  html.ocean{ --bg:#e8f7fb; --card:#fff; --muted:#4f6b75; --text:#063242; --accent-start:#00c2d1; --accent-end:#2b9fff; }
  html.sunset{ --bg:#fff6f8; --card:#fff; --muted:#7a6b77; --text:#2a1020; --accent-start:#ff7aa2; --accent-end:#ffb86b; }

  *{box-sizing:border-box}
  body{margin:0;font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,Arial;color:var(--text);background:linear-gradient(180deg,var(--bg),#e9f6ff);-webkit-font-smoothing:antialiased}
  a{color:inherit;text-decoration:none}
  .container{max-width:1100px;margin:14px auto;padding:14px}

  header.header{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:12px;border-radius:12px;background:linear-gradient(90deg, rgba(107,125,255,0.06), rgba(11,179,255,0.02));box-shadow:var(--shadow-sm)}
  .brand{display:flex;gap:12px;align-items:center;min-width:0}
  .logo{width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,var(--accent-start),var(--accent-end));display:flex;align-items:center;justify-content:center;color:#fff;font-weight:900}
  .brand-title .title-strong{font-size:18px;font-weight:900;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
  .brand-title .by{font-size:12px;color:var(--muted);margin-top:2px}

  .header-actions{display:flex;align-items:center;gap:8px}
  .btn{padding:8px 10px;border-radius:10px;border:none;cursor:pointer;font-weight:800;background:transparent}
  .btn.ghost{background:transparent;border:1px solid rgba(0,0,0,0.06)}
  .btn.theme{background:linear-gradient(90deg,var(--accent-start),var(--accent-end));color:#fff;border-radius:999px;padding:8px 12px;box-shadow:0 6px 18px rgba(107,125,255,0.12)}
  .btn.theme.glow{box-shadow:0 10px 30px rgba(107,125,255,0.28), 0 0 20px rgba(107,125,255,0.12) inset}
  .hamb{width:46px;height:46px;border-radius:10px;background:var(--glass);display:flex;align-items:center;justify-content:center;cursor:pointer;border:1px solid rgba(0,0,0,0.04)}

  .hero{margin-top:16px;padding:18px;border-radius:14px;background:var(--card);box-shadow:var(--shadow-lg);border:1px solid rgba(0,0,0,0.04)}
  .hero .title{font-size:22px;font-weight:900;margin:0}
  .hero .hint{color:var(--muted);margin-top:6px}

  .controls{display:flex;gap:8px;margin-top:12px;flex-wrap:wrap;align-items:center}
  .input{flex:1;min-width:180px}
  input[type="text"]{width:100%;padding:12px;border-radius:10px;border:1px solid rgba(0,0,0,0.06);font-size:16px;background:var(--card);color:var(--text)}
  .primary{background:linear-gradient(90deg,var(--accent-start),var(--accent-end));color:white;padding:10px 16px;border-radius:10px;border:none;font-weight:800;cursor:pointer}

  .small-actions{display:flex;gap:8px;align-items:center;margin-left:8px}

  .results{margin-top:18px}
  .results-header{display:flex;align-items:center;justify-content:space-between;gap:12px}
  .card{background:var(--card);border-radius:12px;padding:14px;box-shadow:var(--shadow-sm);border:1px solid rgba(0,0,0,0.04);margin-top:12px}
  .result-row{display:flex;align-items:center;justify-content:space-between;gap:8px;padding:12px;border-radius:10px;border:1px solid rgba(0,0,0,0.04);margin-bottom:8px;background:linear-gradient(180deg, rgba(255,255,255,0.6), transparent)}
  .result-left{flex:1;min-width:0}
  .result-title{font-weight:700;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
  .result-sub{color:var(--muted);font-size:13px;margin-top:6px}
  .result-actions{display:flex;gap:8px}
  .btn.copy{padding:8px 12px;border-radius:10px;background:#fff;border:1px solid rgba(0,0,0,0.06);cursor:pointer;font-weight:700}
  .btn.use{padding:8px 12px;border-radius:10px;background:rgba(0,0,0,0.04);border:1px solid rgba(0,0,0,0.04);cursor:pointer;font-weight:700}

  .category-title{font-weight:900;margin:6px 0 12px 0}
  .load-more{display:block;margin:8px auto;padding:10px 14px;border-radius:10px;border:1px solid rgba(0,0,0,0.06);background:transparent;cursor:pointer;font-weight:800}

  .sidebar{position:fixed;right:18px;top:90px;width:320px;background:var(--card);border-radius:12px;padding:12px;box-shadow:var(--shadow-lg);border:1px solid rgba(0,0,0,0.06);display:none}
  .sidebar h3{margin:0 0 8px 0}
  .sidebar a{display:block;padding:8px;border-radius:8px;color:var(--text);text-decoration:none}
  .muted{color:var(--muted)}

  footer{margin-top:18px;padding:14px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.92), rgba(255,255,255,0.96));text-align:center;box-shadow:var(--shadow-lg)}

  @media(max-width:980px){
    .sidebar{position:static;width:auto;margin-top:12px}
  }
  @media(max-width:520px){
    .logo{width:48px;height:48px}
    .brand-title .title-strong{font-size:16px}
    .controls{flex-direction:column;align-items:stretch}
    .result-actions{flex-direction:row-reverse}
    .result-title{font-size:16px}
  }
</style>
</head>
<body>
<div class="container">
  <header class="header" role="banner">
    <div class="brand">
      <div class="logo" aria-hidden="true">PR</div>
      <div class="brand-title">
        <div class="title-strong">Font Generator</div>
        <div class="by">by PirateRuler.com</div>
      </div>
    </div>

    <div class="header-actions" role="navigation">
      <div class="theme-select" id="themeSelectWrap">
        <button id="themeBtn" class="btn theme glow" title="Theme">Light ‚ñæ</button>
        <div id="themeList" style="display:none;position:absolute;right:18px;top:72px;background:var(--card);border-radius:10px;padding:8px;box-shadow:var(--shadow-sm);z-index:1000;">
          <div class="theme-item" data-theme="light" style="padding:8px;cursor:pointer">Light</div>
          <div class="theme-item" data-theme="dark" style="padding:8px;cursor:pointer">Dark</div>
          <div class="theme-item" data-theme="ocean" style="padding:8px;cursor:pointer">Ocean</div>
          <div class="theme-item" data-theme="sunset" style="padding:8px;cursor:pointer">Sunset</div>
        </div>
      </div>
      <div id="hambBtn" class="hamb" title="Open menu" aria-haspopup="true" aria-controls="sidebar">‚ò∞</div>
    </div>
  </header>

  <section class="hero" aria-labelledby="heroTitle">
    <h1 id="heroTitle" class="title">Font Generator</h1>
    <div class="hint">Type text below and get stylized versions you can copy ‚Äî client-side, no API.</div>
    <div class="controls">
      <div class="input">
        <input id="inputText" type="text" placeholder="Type something to transform ‚Äî e.g. PirateRuler" value="PirateRuler" />
      </div>
      <button id="generateBtn" class="primary">Generate</button>

      <div class="small-actions">
        <button id="copyAllBtn" class="btn ghost">Copy All</button>
        <button id="downloadBtn" class="btn ghost">Download .txt</button>
      </div>
    </div>
  </section>

  <div class="results" id="results">
    <div class="results-header">
      <div><strong id="countLabel">0</strong> results</div>
      <div class="muted">Client-side transforms ‚Äî no API</div>
    </div>
    <!-- categories + transforms injected here by JS -->
  </div>

  <aside class="sidebar" id="sidebar" aria-hidden="true">
    <div style="display:flex;justify-content:flex-end"><button id="closeSidebar" class="btn ghost">Close</button></div>
    <h3>PirateRuler Links</h3>
    <nav style="display:flex;flex-direction:column;gap:8px;margin-top:10px">
      <a href="/post/about.html" target="_blank" rel="noopener noreferrer">About ‚Äî PirateRuler</a>
      <a href="/post/privacy.html" target="_blank" rel="noopener noreferrer">Privacy Policy</a>
      <a href="/post/contact.html" target="_blank" rel="noopener noreferrer">Contact</a>
      <a href="/post/terms.html" target="_blank" rel="noopener noreferrer">Terms & Service</a>
    </nav>
    <div style="margin-top:18px;color:var(--muted);font-size:13px">
      If this site is offline you can visit PirateRuler for backups & resources: <a href="https://pirateruler.com" target="_blank">pirateruler.com</a>
    </div>
    <div style="margin-top:12px;font-size:13px;color:var(--muted)"><strong>How to use</strong>
      <ol style="margin:6px 0 0 18px">
        <li>Type your text and press Generate (or Enter).</li>
        <li>Tap <em>Use</em> to place the transformed text back into input.</li>
        <li>Tap <em>Copy</em> to copy a transform or use Copy All / Download .txt.</li>
      </ol>
    </div>
  </aside>

  <footer>
    <div style="margin-bottom:8px">About PirateRuler Fonts ‚Äî lightweight client-side font transforms for social captions, bios, and quick mockups.</div>
    <a class="visit" href="https://pirateruler.com" target="_blank" rel="noopener noreferrer">Visit PirateRuler.com</a>
    <div style="height:8px"></div>
    <small class="muted">¬© <span id="year"></span> PirateRuler</small>
  </footer>
</div>

<script>
/* ---------- Utilities ---------- */
const $ = id => document.getElementById(id);
const inputText = $('inputText'), generateBtn = $('generateBtn'), results = $('results');
const copyAllBtn = $('copyAllBtn'), downloadBtn = $('downloadBtn'), countLabel = $('countLabel');
const themeBtn = $('themeBtn'), themeList = document.getElementById('themeList');
const sidebar = $('sidebar'), hambBtn = $('hambBtn'), closeSidebar = $('closeSidebar');
$('year').textContent = new Date().getFullYear();

function copyText(text){
  if(!navigator.clipboard){ const ta=document.createElement('textarea'); ta.value=text; document.body.appendChild(ta); ta.select(); try{ document.execCommand('copy'); }catch(e){} ta.remove(); return; }
  return navigator.clipboard.writeText(text);
}
function downloadText(name, text){
  const a=document.createElement('a'); a.href=URL.createObjectURL(new Blob([text],{type:'text/plain'})); a.download=name; a.click(); URL.revokeObjectURL(a.href);
}
function showToast(msg){
  const t=document.createElement('div'); t.textContent=msg; t.style.position='fixed'; t.style.bottom='18px'; t.style.left='50%'; t.style.transform='translateX(-50%)'; t.style.padding='8px 12px'; t.style.borderRadius='10px'; t.style.background='rgba(0,0,0,0.75)'; t.style.color='white'; t.style.zIndex=99999; document.body.appendChild(t); setTimeout(()=>t.remove(),900);
}

/* ---------- small mapping helpers ---------- */
function mapWithTable(s, table){
  return Array.from(s).map(c => table[c] ?? table[c.toLowerCase()] ?? c).join('');
}
function joinSep(s, sep){ return Array.from(s).join(sep); }

/* small mapping tables */
const SMALL_CAPS = { a:'·¥Ä',b:' ô',c:'·¥Ñ',d:'·¥Ö',e:'·¥á',f:'Íú∞',g:'…¢',h:' ú',i:'…™',j:'·¥ä',k:'·¥ã',l:' ü',m:'·¥ç',n:'…¥',o:'·¥è',p:'·¥ò',q:'«´',r:' Ä',s:'s',t:'·¥õ',u:'·¥ú',v:'·¥†',w:'·¥°',x:'x',y:' è',z:'·¥¢'};
const UPSIDE = { a:'…ê',b:'q',c:'…î',d:'p',e:'«ù',f:'…ü',g:'…ì',h:'…•',i:'·¥â',j:'…æ',k:' û',l:' É',m:'…Ø',n:'u',o:'o',p:'d',q:'b',r:'…π',s:'s',t:' á',u:'n',v:' å',w:' ç',x:'x',y:' é',z:'z',
  '.':'Àô','?':'¬ø','!':'¬°','\'':',','"':',,','(':')',')':'(','[':']',']':'[','<':'>','>':'<'};
const MIRROR = { a:'…í', b:'q', c:'…î', d:'p', e:'…ò', f:'…ü', g:'…ì', h:'…•', i:'ƒ±', j:'…æ', k:' û', l:'l', m:'…Ø', n:'u', o:'o', p:'d', q:'b', r:'…ø', s:'s', t:' á', u:'n', v:' å', w:' ç', x:'x', y:' é', z:'z' };
const CIRCLE = (function(){ const m={}; for(let i=0;i<26;i++){ m[String.fromCharCode(65+i)]=String.fromCharCode(0x24B6+i); m[String.fromCharCode(97+i)]=String.fromCharCode(0x24D0+i);} for(let i=0;i<10;i++){ m[String(i)]=["‚ì™","‚ë†","‚ë°","‚ë¢","‚ë£","‚ë§","‚ë•","‚ë¶","‚ëß","‚ë®"][i]; } return m; })();
const BUBBLE = CIRCLE; // reuse circled as bubble
const FULLWIDTH = (function(){ const m={}; for(let i=0;i<26;i++){ m[String.fromCharCode(65+i)]=String.fromCharCode(0xFF21+i); m[String.fromCharCode(97+i)]=String.fromCharCode(0xFF41+i);} for(let i=0;i<10;i++) m[String(i)]=String.fromCharCode(0xFF10+i); return m; })();

/* combining diacritics for accenting */
const COMBINING = ['\u0300','\u0301','\u0302','\u0303','\u0304','\u0306','\u0307','\u0308','\u0327','\u0323'];

/* ---------- base transforms ---------- */
/* lightweight base transforms (we will auto-combine to hit 150+) */
const BASE_TRANSFORMS = [
  {id:'plain', name:'Plain', cat:'Basic', fn: s => s},
  {id:'upper', name:'UPPERCASE', cat:'Basic', fn: s => s.toUpperCase()},
  {id:'lower', name:'lowercase', cat:'Basic', fn: s => s.toLowerCase()},
  {id:'title', name:'Title Case', cat:'Basic', fn: s => s.replace(/\w\S*/g, w=>w.charAt(0).toUpperCase()+w.slice(1).toLowerCase())},
  {id:'smallcaps', name:'Small Caps', cat:'Case', fn: s => mapWithTable(s.toLowerCase(), SMALL_CAPS)},
  {id:'spaced', name:'Spaced letters', cat:'Spacing', fn: s => joinSep(s,' ')},
  {id:'dotted', name:'Dotted', cat:'Spacing', fn: s => joinSep(s,'¬∑')},
  {id:'fullwidth', name:'Fullwidth', cat:'Symbols', fn: s => mapWithTable(s, FULLWIDTH)},
  {id:'circled', name:'Circled', cat:'Fancy', fn: s => mapWithTable(s, CIRCLE)},
  {id:'bubble', name:'Bubble', cat:'Fancy', fn: s => mapWithTable(s, BUBBLE)},
  {id:'upsidedown', name:'Upside Down', cat:'Fun', fn: s => Array.from(s).reverse().map(c=>UPSIDE[c.toLowerCase()]||UPSIDE[c]||c).join('')},
  {id:'mirror', name:'Mirror-ish', cat:'Fun', fn: s => mapWithTable(s, MIRROR)},
  {id:'brackets', name:'[brackets]', cat:'Wrappers', fn: s => Array.from(s).map(c=>'['+c+']').join('')},
  {id:'parenthesis', name:'(parenthesis)', cat:'Wrappers', fn: s => Array.from(s).map(c=>'('+c+')').join('')},
  {id:'boxed', name:'‚ñ£ Boxes', cat:'Wrappers', fn: s => Array.from(s).map(c=>'‚ñ£'+c+'‚ñ£').join('')},
  {id:'accent', name:'Combining Accents', cat:'Accents', fn: s => Array.from(s).map(c=> c + COMBINING[Math.floor(Math.random()*COMBINING.length)]).join('')},
  {id:'dotsAbove', name:'Dots Above', cat:'Accents', fn: s => Array.from(s).map(c=> c + '\u0307').join('')},
  {id:'reverse', name:'Reversed', cat:'Misc', fn: s => Array.from(s).reverse().join('')},
  {id:'fullspace', name:'Full Spaced', cat:'Spacing', fn: s => Array.from(s).map(c=> c + '\u200A').join('')},
  {id:'tiny', name:'Tiny (sub-like)', cat:'Symbols', fn: s => mapWithTable(s, {a:'‚Çê',e:'‚Çë',i:'·µ¢',o:'‚Çí',u:'·µ§',r:'·µ£',t:'‚Çú',s:'‚Çõ',n:'‚Çô'})},
  {id:'braille', name:'Braille-ish', cat:'Fun', fn: s => Array.from(s).map(c=> String.fromCodePoint(0x2800 + (c.charCodeAt(0) % 256))).join('')},
];

/* ---------- auto-generate many transforms by composing decorators ---------- */
function compose(fn1, fn2){
  return s => fn2(fn1(s));
}

/* decorator helpers */
const DECORATORS = [
  {id:'spaced', name:' Spaced', fn: s => joinSep(s,' ')},
  {id:'dot', name:' ¬∑dotted', fn: s => joinSep(s,'¬∑')},
  {id:'circ', name:' (circled)', fn: s => mapWithTable(s, CIRCLE)},
  {id:'bubble', name:' (bubble)', fn: s => mapWithTable(s, BUBBLE)},
  {id:'fullw', name:' (fullwidth)', fn: s => mapWithTable(s, FULLWIDTH)},
  {id:'accent', name:' (accented)', fn: s => Array.from(s).map(c=>c + COMBINING[Math.floor(Math.random()*COMBINING.length)]).join('')},
  {id:'paren', name:' (parenthesis)', fn: s => Array.from(s).map(c=>'('+c+')').join('')},
  {id:'brack', name:' (brackets)', fn: s => Array.from(s).map(c=>'['+c+']').join('')},
  {id:'up', name:' (upside)', fn: s => Array.from(s).reverse().map(c=>UPSIDE[c.toLowerCase()]||UPSIDE[c]||c).join('')},
  {id:'mirror', name:' (mirror)', fn: s => mapWithTable(s, MIRROR)}
];

/* Build final TRANSFORMS array programmatically */
let TRANSFORMS = [];
// first include all base transforms
BASE_TRANSFORMS.forEach(t => TRANSFORMS.push(Object.assign({}, t)));

// now generate combinations: for each base, apply each decorator and combinations of 2 decorators
BASE_TRANSFORMS.forEach(base => {
  DECORATORS.forEach(dec => {
    TRANSFORMS.push({
      id: base.id + '_' + dec.id,
      name: base.name + dec.name,
      cat: base.cat,
      fn: compose(base.fn, dec.fn)
    });
  });
  // combos of two decorators (limited)
  for(let i=0;i<DECORATORS.length;i++){
    for(let j=i+1;j<DECORATORS.length;j++){
      const d1 = DECORATORS[i], d2 = DECORATORS[j];
      TRANSFORMS.push({
        id: base.id + '_' + d1.id + '_' + d2.id,
        name: base.name + d1.name + d2.name,
        cat: base.cat,
        fn: compose(base.fn, compose(d1.fn, d2.fn))
      });
    }
  }
});

// additional generated stylistic transforms (fullwidth variants, doubled, wrapped with emoji, etc.)
const EXTRA = [
  {name:'Star-wrapped ‚ú¶', cat:'Decor', fn: s => `‚ú¶ ${s} ‚ú¶`},
  {name:'Arrowed ‚Üí', cat:'Decor', fn: s => Array.from(s).join(' ‚Üí ')},
  {name:'Underline-like', cat:'Decor', fn: s => s + '\n' + '-'.repeat(Math.min(40, s.length))},
  {name:'Slashy /', cat:'Decor', fn: s => Array.from(s).map(c=>'/'+c).join('')},
  {name:'Double-struck-like', cat:'Math', fn: s => mapWithTable(s, {A:'ùî∏',B:'ùîπ',C:'‚ÑÇ',D:'ùîª',E:'ùîº',F:'ùîΩ',G:'ùîæ',H:'‚Ñç',I:'ùïÄ',J:'ùïÅ',K:'ùïÇ',L:'ùïÉ',M:'ùïÑ',N:'‚Ñï',O:'ùïÜ',P:'ùï°',Q:'ùïä',R:'‚Ñù',S:'ùïä',T:'ùïã',U:'ùïå',V:'ùïç',W:'ùïé',X:'ùïè',Y:'ùïê',Z:'‚Ñ§'})},
  {name:'Weird flip', cat:'Fun', fn: s => mapWithTable(s, {a:'…í',b:'d',c:'…î',d:'b',e:'«ù',f:'…ü',g:'∆É',h:'…•',i:'·¥â',j:'…æ',k:' û',l:' É',m:'…Ø',n:'u',o:'o',p:'q',q:'p',r:'…π',s:'s',t:' á',u:'n',v:' å',w:' ç',x:'x',y:' é',z:'z'})},
];
EXTRA.forEach((ex,i) => {
  TRANSFORMS.push({id:'extra_'+i, name:ex.name, cat:ex.cat, fn:ex.fn});
});

// Ensure uniqueness and order
const seen = new Set();
TRANSFORMS = TRANSFORMS.filter(t => {
  if(seen.has(t.name)) return false;
  seen.add(t.name);
  return true;
});

// If the generation didn't reach 150, produce more simple decorated variations programmatically
let idx = 0;
while(TRANSFORMS.length < 160){
  const base = BASE_TRANSFORMS[idx % BASE_TRANSFORMS.length];
  const dec = DECORATORS[idx % DECORATORS.length];
  TRANSFORMS.push({
    id: base.id + '_auto'+idx,
    name: base.name + dec.name + ' #' + (Math.floor(idx/DECORATORS.length)+1),
    cat: base.cat,
    fn: compose(base.fn, dec.fn)
  });
  idx++;
}

/* ---------- UI: render grouped categories with per-category Load more ---------- */
function groupByCategory(list){
  const out = {};
  list.forEach(t => { out[t.cat] = out[t.cat]||[]; out[t.cat].push(t); });
  return out;
}
const grouped = groupByCategory(TRANSFORMS);
const perCategoryDefault = 12; // initial show per category
const showCount = {};
Object.keys(grouped).forEach(k => showCount[k] = perCategoryDefault);

function makeRow(transform, text){
  let out = '';
  try{ out = transform.fn(text || ''); }catch(e){ out = text; }
  const row = document.createElement('div'); row.className = 'result-row';
  const left = document.createElement('div'); left.className='result-left';
  const title = document.createElement('div'); title.className='result-title'; title.textContent = out;
  const sub = document.createElement('div'); sub.className='result-sub'; sub.textContent = transform.name;
  left.appendChild(title); left.appendChild(sub);

  const actions = document.createElement('div'); actions.className='result-actions';
  const copyBtn = document.createElement('button'); copyBtn.className='btn copy'; copyBtn.textContent='Copy';
  copyBtn.addEventListener('click', async ()=> {
    await copyText(out); copyBtn.textContent='Copied'; setTimeout(()=>copyBtn.textContent='Copy',800);
    showToast('Copied');
  });
  const useBtn = document.createElement('button'); useBtn.className='btn use'; useBtn.textContent='Use';
  useBtn.addEventListener('click', ()=> { inputText.value = out; inputText.focus(); });
  actions.appendChild(copyBtn); actions.appendChild(useBtn);

  row.appendChild(left); row.appendChild(actions);
  return row;
}

function renderAll(text){
  // clear previous category blocks
  document.querySelectorAll('.cat-block').forEach(n=>n.remove());
  const cats = Object.keys(grouped).sort();
  cats.forEach(cat => {
    const arr = grouped[cat] || [];
    const block = document.createElement('div'); block.className='card cat-block';
    const heading = document.createElement('div'); heading.className='category-title'; heading.textContent = `${cat} (${arr.length})`;
    block.appendChild(heading);
    const listWrap = document.createElement('div');
    const toShow = Math.min(showCount[cat] || perCategoryDefault, arr.length);
    for(let i=0;i<toShow;i++){
      listWrap.appendChild(makeRow(arr[i], text));
    }
    block.appendChild(listWrap);
    if(arr.length > toShow){
      const lm = document.createElement('button'); lm.className='load-more'; lm.textContent='Load more';
      lm.addEventListener('click', ()=> {
        const now = Math.min((showCount[cat]||perCategoryDefault)+24, arr.length);
        showCount[cat] = now;
        for(let i=toShow;i<now;i++) listWrap.appendChild(makeRow(arr[i], text));
        if(now >= arr.length) lm.remove();
      });
      block.appendChild(lm);
    }
    results.appendChild(block);
  });
  countLabel.textContent = TRANSFORMS.length;
}

/* initial render with default input */
renderAll(inputText.value || 'PirateRuler');

/* ---------- buttons ---------- */
generateBtn.addEventListener('click', ()=> {
  const t = inputText.value || '';
  if(!t.trim()) return alert('Type some text first.');
  // clear existing .cat-block nodes to re-render
  renderAll(t);
});

inputText.addEventListener('keydown', (e)=> { if(e.key === 'Enter') generateBtn.click(); });

copyAllBtn.addEventListener('click', async ()=> {
  const t = inputText.value || '';
  if(!t.trim()) return alert('Type some text first.');
  let out = '';
  Object.keys(grouped).sort().forEach(cat => {
    out += cat + '\n';
    grouped[cat].forEach(tr => out += (tr.fn(t) || '') + '\n');
    out += '\n';
  });
  await copyText(out); showToast('All transforms copied');
});

downloadBtn.addEventListener('click', ()=> {
  const t = inputText.value || '';
  if(!t.trim()) return alert('Type some text first.');
  let out = '';
  Object.keys(grouped).sort().forEach(cat => {
    out += cat + '\n';
    grouped[cat].forEach(tr => out += (tr.fn(t) || '') + '\n');
    out += '\n';
  });
  downloadText('pirateruler-fonts.txt', out);
});

/* ---------- theme and sidebar behavior ---------- */
themeBtn.addEventListener('click', ()=> { themeList.style.display = themeList.style.display === 'block' ? 'none' : 'block'; });
document.querySelectorAll('.theme-item').forEach(it => it.addEventListener('click', ()=> {
  const name = it.dataset.theme;
  ['dark','ocean','sunset'].forEach(c=>document.documentElement.classList.remove(c));
  if(name !== 'light') document.documentElement.classList.add(name);
  themeBtn.textContent = (name.charAt(0).toUpperCase()+name.slice(1)) + ' ‚ñæ';
  localStorage.setItem('pr-fonts-theme', name);
  themeList.style.display = 'none';
}));
(function(){ const t=localStorage.getItem('pr-fonts-theme')||'light'; if(t!=='light') document.documentElement.classList.add(t); themeBtn.textContent = (t.charAt(0).toUpperCase()+t.slice(1)) + ' ‚ñæ'; })();

// Sidebar: hidden by default, toggled by menu button (desktop & mobile)
hambBtn.addEventListener('click', ()=> {
  if(sidebar.style.display === 'block'){ sidebar.style.display='none'; sidebar.setAttribute('aria-hidden','true'); }
  else { sidebar.style.display='block'; sidebar.setAttribute('aria-hidden','false'); }
});
closeSidebar.addEventListener('click', ()=> { sidebar.style.display='none'; sidebar.setAttribute('aria-hidden','true'); });

// hide theme list when clicking outside
document.addEventListener('click', (e)=> { if(!document.getElementById('themeSelectWrap')?.contains(e.target)) themeList.style.display='none'; });

/* ---------- done ---------- */
</script>
</body>
</html>
